{"version":3,"kind":"Notebook","sha256":"22626dfe7bd9dc5b1171f016164f961a3cd5479c47e9fde2224d445ecaa972c2","slug":"notebooks.snotel-data-access","location":"/notebooks/snotel_data_access.ipynb","dependencies":[],"frontmatter":{"title":"SNOTEL Data Access","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"snow-observations-cookbook-test","language":"python"},"authors":[{"nameParsed":{"literal":"The NASA Snow Observations Community","given":"The NASA Snow Observations","family":"Community"},"name":"The NASA Snow Observations Community","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/SnowEx/snow-observations-cookbook","copyright":"2025","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/SnowEx/snow-observations-cookbook/blob/main/notebooks/snotel_data_access.ipynb","edit_url":"https://github.com/SnowEx/snow-observations-cookbook/edit/main/notebooks/snotel_data_access.ipynb","exports":[{"format":"ipynb","filename":"snotel_data_access.ipynb","url":"/snow-observations-cookbook/build/snotel_data_access-7ffc8fe6d3cd8d9eebb1891bfed48e89.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This notebook allows for easy access to snow depths and SWE from the Snow Telemetry (SNOTEL) network. A simple example is used to show quick access to SNOTEL data over Creamer’s Field, AK using the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"re82k1Bwwz"},{"type":"inlineCode","value":"metloom","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YnIvsxopts"},{"type":"text","value":" package.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hx2zNRBRHI"}],"key":"KaJTWwLXgn"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Credit: M3Works for the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"sIEP581bbO"},{"type":"inlineCode","value":"metloom","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Azh8ZjybMk"},{"type":"text","value":" package, which can be found here: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fNpFN5bUzj"},{"type":"link","url":"https://github.com/M3Works/metloom/tree/main","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"https://​github​.com​/M3Works​/metloom​/tree​/main","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"EaGX92CViS"}],"urlSource":"https://github.com/M3Works/metloom/tree/main","error":true,"key":"H2mtFOm7v3"}],"key":"yIxr904S5l"}],"key":"pmB9gOpPPV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from datetime import datetime\nimport pandas as pd\nimport geopandas as gpd\nfrom pathlib import Path\nimport matplotlib.pyplot as plt","key":"Q5DkVm6npe"},{"type":"outputs","id":"M7dhZUekxsGifc9ADA1cZ","children":[],"key":"AwQc4JXkF4"}],"key":"O3wLNSPJJ4"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Metloom allows for easy access to several weather station types, including SNOTEL, MesoWest, and NorwayMet. The primary query function for each is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VTdcaA7OPJ"},{"type":"inlineCode","value":"SnotelPointData","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ryk46XnjTq"},{"type":"text","value":" (replace “Snotel” with station of choice), which also allows us to view the locations of weather stations. We’ll start this example doing just that.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PtUZgOFhRd"}],"key":"IFMq228LaZ"}],"key":"gKfstmgLP4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Import the SNOTEL pointdata classes\nfrom metloom.pointdata import SnotelPointData\n\n# Import the SNOTEL variable classes\nfrom metloom.variables import SnotelVariables","key":"jGgy3MsSel"},{"type":"outputs","id":"nv7FDncs0bDU0LJXaj026","children":[],"key":"oCC2AWaZ4x"}],"key":"Glzm9aB3nq"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We are going to look for active SNOTEL stations near Creamer’s Field in Fairbanks, AK. The below cells search for SNOTEL stations within 0.5 degrees latitude/longitude of the provided polygon.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EgvyNjaDZs"}],"key":"Jxn5KGow23"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We will also go ahead and define the variables we want from the station, using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qzLMoZgZey"},{"type":"inlineCode","value":"SnotelPointData.ALLOWED_VARIABLES","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UtHql0vm12"},{"type":"text","value":". Some of the allowed variables include:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"a5NQx4Nm08"}],"key":"Y3z4qrwkZf"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"SNOWDEPTH","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"DxpyrcWL9C"},{"type":"text","value":": Snow depth, typically in inches.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ZHMQ589tYC"}],"key":"eXKKFUYDEX"}],"key":"PnJjIv06hV"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"SWE","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CMCcwlrnxx"},{"type":"text","value":": Snow water equivalent, typically in inches.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BJPd746UDa"}],"key":"rFcgUqrRud"}],"key":"Wo3GKIQEPS"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"PRECIPITATION","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"mRuicsYNS0"},{"type":"text","value":": Accumulated precipitation, in inches.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"KLcIqaJmad"}],"key":"Vx8joRNQZ3"}],"key":"uBIH9mxbbL"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"TMP","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"HslaOz5MtU"},{"type":"text","value":": Air temperature, in degrees Fahrenheit.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"p86a2caplr"}],"key":"aZRGATinR4"}],"key":"U2GT0EXNe6"}],"key":"P0Z2we1b4s"}],"key":"xZ8HBFMlch"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Load FLCF lidar box from SnowEx campaigns\nsf_path = Path(\"data/cffl_lidar_box.geojson\").expanduser()\nsf = gpd.read_file(str(sf_path))\nsf[\"name\"] = [\"FLCF\"]\n\n# Load the desired variables for SNOTEL query\nvariables = [SnotelPointData.ALLOWED_VARIABLES.SNOWDEPTH]","key":"SRRi2a9BBx"},{"type":"outputs","id":"rkkNHie5BkfG1lYPGksYs","children":[],"key":"x406GUImuP"}],"key":"nCY3qURuVw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Find SNOTEL stations within polygon with desired variables\npoints = SnotelPointData.points_from_geometry(sf, variables)\n\n# Print nearby SNOTEL stations within 0.5 degrees of polygon\nprint(SnotelPointData.points_from_geometry(sf, variables, buffer=0.5).points)","key":"CMJ1fewFSf"},{"type":"outputs","id":"UI91fMWd5gjM42o-YTQb_","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mTimeoutError\u001b[39m                              Traceback (most recent call last)\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/urllib3/connection.py:204\u001b[39m, in \u001b[36mHTTPConnection._new_conn\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m    203\u001b[39m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[32m--> \u001b[39m\u001b[32m204\u001b[39m     sock = \u001b[43mconnection\u001b[49m\u001b[43m.\u001b[49m\u001b[43mcreate_connection\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m    205\u001b[39m \u001b[43m        \u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_dns_host\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mport\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    206\u001b[39m \u001b[43m        \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mtimeout\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    207\u001b[39m \u001b[43m        \u001b[49m\u001b[43msource_address\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43msource_address\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    208\u001b[39m \u001b[43m        \u001b[49m\u001b[43msocket_options\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43msocket_options\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    209\u001b[39m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    210\u001b[39m \u001b[38;5;28;01mexcept\u001b[39;00m socket.gaierror \u001b[38;5;28;01mas\u001b[39;00m e:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/urllib3/util/connection.py:85\u001b[39m, in \u001b[36mcreate_connection\u001b[39m\u001b[34m(address, timeout, source_address, socket_options)\u001b[39m\n\u001b[32m     84\u001b[39m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[32m---> \u001b[39m\u001b[32m85\u001b[39m     \u001b[38;5;28;01mraise\u001b[39;00m err\n\u001b[32m     86\u001b[39m \u001b[38;5;28;01mfinally\u001b[39;00m:\n\u001b[32m     87\u001b[39m     \u001b[38;5;66;03m# Break explicitly a reference cycle\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/urllib3/util/connection.py:73\u001b[39m, in \u001b[36mcreate_connection\u001b[39m\u001b[34m(address, timeout, source_address, socket_options)\u001b[39m\n\u001b[32m     72\u001b[39m     sock.bind(source_address)\n\u001b[32m---> \u001b[39m\u001b[32m73\u001b[39m \u001b[43msock\u001b[49m\u001b[43m.\u001b[49m\u001b[43mconnect\u001b[49m\u001b[43m(\u001b[49m\u001b[43msa\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     74\u001b[39m \u001b[38;5;66;03m# Break explicitly a reference cycle\u001b[39;00m\n\n\u001b[31mTimeoutError\u001b[39m: [Errno 110] Connection timed out\n\nThe above exception was the direct cause of the following exception:\n\n\u001b[31mConnectTimeoutError\u001b[39m                       Traceback (most recent call last)\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/urllib3/connectionpool.py:787\u001b[39m, in \u001b[36mHTTPConnectionPool.urlopen\u001b[39m\u001b[34m(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, preload_content, decode_content, **response_kw)\u001b[39m\n\u001b[32m    786\u001b[39m \u001b[38;5;66;03m# Make the request on the HTTPConnection object\u001b[39;00m\n\u001b[32m--> \u001b[39m\u001b[32m787\u001b[39m response = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_make_request\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m    788\u001b[39m \u001b[43m    \u001b[49m\u001b[43mconn\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    789\u001b[39m \u001b[43m    \u001b[49m\u001b[43mmethod\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    790\u001b[39m \u001b[43m    \u001b[49m\u001b[43murl\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    791\u001b[39m \u001b[43m    \u001b[49m\u001b[43mtimeout\u001b[49m\u001b[43m=\u001b[49m\u001b[43mtimeout_obj\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    792\u001b[39m \u001b[43m    \u001b[49m\u001b[43mbody\u001b[49m\u001b[43m=\u001b[49m\u001b[43mbody\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    793\u001b[39m \u001b[43m    \u001b[49m\u001b[43mheaders\u001b[49m\u001b[43m=\u001b[49m\u001b[43mheaders\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    794\u001b[39m \u001b[43m    \u001b[49m\u001b[43mchunked\u001b[49m\u001b[43m=\u001b[49m\u001b[43mchunked\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    795\u001b[39m \u001b[43m    \u001b[49m\u001b[43mretries\u001b[49m\u001b[43m=\u001b[49m\u001b[43mretries\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    796\u001b[39m \u001b[43m    \u001b[49m\u001b[43mresponse_conn\u001b[49m\u001b[43m=\u001b[49m\u001b[43mresponse_conn\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    797\u001b[39m \u001b[43m    \u001b[49m\u001b[43mpreload_content\u001b[49m\u001b[43m=\u001b[49m\u001b[43mpreload_content\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    798\u001b[39m \u001b[43m    \u001b[49m\u001b[43mdecode_content\u001b[49m\u001b[43m=\u001b[49m\u001b[43mdecode_content\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    799\u001b[39m \u001b[43m    \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mresponse_kw\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    800\u001b[39m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    802\u001b[39m \u001b[38;5;66;03m# Everything went great!\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/urllib3/connectionpool.py:488\u001b[39m, in \u001b[36mHTTPConnectionPool._make_request\u001b[39m\u001b[34m(self, conn, method, url, body, headers, retries, timeout, chunked, response_conn, preload_content, decode_content, enforce_content_length)\u001b[39m\n\u001b[32m    487\u001b[39m         new_e = _wrap_proxy_error(new_e, conn.proxy.scheme)\n\u001b[32m--> \u001b[39m\u001b[32m488\u001b[39m     \u001b[38;5;28;01mraise\u001b[39;00m new_e\n\u001b[32m    490\u001b[39m \u001b[38;5;66;03m# conn.request() calls http.client.*.request, not the method in\u001b[39;00m\n\u001b[32m    491\u001b[39m \u001b[38;5;66;03m# urllib3.request. It also calls makefile (recv) on the socket.\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/urllib3/connectionpool.py:464\u001b[39m, in \u001b[36mHTTPConnectionPool._make_request\u001b[39m\u001b[34m(self, conn, method, url, body, headers, retries, timeout, chunked, response_conn, preload_content, decode_content, enforce_content_length)\u001b[39m\n\u001b[32m    463\u001b[39m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[32m--> \u001b[39m\u001b[32m464\u001b[39m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_validate_conn\u001b[49m\u001b[43m(\u001b[49m\u001b[43mconn\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    465\u001b[39m \u001b[38;5;28;01mexcept\u001b[39;00m (SocketTimeout, BaseSSLError) \u001b[38;5;28;01mas\u001b[39;00m e:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/urllib3/connectionpool.py:1093\u001b[39m, in \u001b[36mHTTPSConnectionPool._validate_conn\u001b[39m\u001b[34m(self, conn)\u001b[39m\n\u001b[32m   1092\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m conn.is_closed:\n\u001b[32m-> \u001b[39m\u001b[32m1093\u001b[39m     \u001b[43mconn\u001b[49m\u001b[43m.\u001b[49m\u001b[43mconnect\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1095\u001b[39m \u001b[38;5;66;03m# TODO revise this, see https://github.com/urllib3/urllib3/issues/2791\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/urllib3/connection.py:759\u001b[39m, in \u001b[36mHTTPSConnection.connect\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m    758\u001b[39m sock: socket.socket | ssl.SSLSocket\n\u001b[32m--> \u001b[39m\u001b[32m759\u001b[39m \u001b[38;5;28mself\u001b[39m.sock = sock = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_new_conn\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    760\u001b[39m server_hostname: \u001b[38;5;28mstr\u001b[39m = \u001b[38;5;28mself\u001b[39m.host\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/urllib3/connection.py:213\u001b[39m, in \u001b[36mHTTPConnection._new_conn\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m    212\u001b[39m \u001b[38;5;28;01mexcept\u001b[39;00m SocketTimeout \u001b[38;5;28;01mas\u001b[39;00m e:\n\u001b[32m--> \u001b[39m\u001b[32m213\u001b[39m     \u001b[38;5;28;01mraise\u001b[39;00m ConnectTimeoutError(\n\u001b[32m    214\u001b[39m         \u001b[38;5;28mself\u001b[39m,\n\u001b[32m    215\u001b[39m         \u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mConnection to \u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;28mself\u001b[39m.host\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m timed out. (connect timeout=\u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;28mself\u001b[39m.timeout\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m)\u001b[39m\u001b[33m\"\u001b[39m,\n\u001b[32m    216\u001b[39m     ) \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01me\u001b[39;00m\n\u001b[32m    218\u001b[39m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mOSError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m e:\n\n\u001b[31mConnectTimeoutError\u001b[39m: (<HTTPSConnection(host='wcc.sc.egov.usda.gov', port=443) at 0x7fc7ad3697f0>, 'Connection to wcc.sc.egov.usda.gov timed out. (connect timeout=300)')\n\nThe above exception was the direct cause of the following exception:\n\n\u001b[31mMaxRetryError\u001b[39m                             Traceback (most recent call last)\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/requests/adapters.py:644\u001b[39m, in \u001b[36mHTTPAdapter.send\u001b[39m\u001b[34m(self, request, stream, timeout, verify, cert, proxies)\u001b[39m\n\u001b[32m    643\u001b[39m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[32m--> \u001b[39m\u001b[32m644\u001b[39m     resp = \u001b[43mconn\u001b[49m\u001b[43m.\u001b[49m\u001b[43murlopen\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m    645\u001b[39m \u001b[43m        \u001b[49m\u001b[43mmethod\u001b[49m\u001b[43m=\u001b[49m\u001b[43mrequest\u001b[49m\u001b[43m.\u001b[49m\u001b[43mmethod\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    646\u001b[39m \u001b[43m        \u001b[49m\u001b[43murl\u001b[49m\u001b[43m=\u001b[49m\u001b[43murl\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    647\u001b[39m \u001b[43m        \u001b[49m\u001b[43mbody\u001b[49m\u001b[43m=\u001b[49m\u001b[43mrequest\u001b[49m\u001b[43m.\u001b[49m\u001b[43mbody\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    648\u001b[39m \u001b[43m        \u001b[49m\u001b[43mheaders\u001b[49m\u001b[43m=\u001b[49m\u001b[43mrequest\u001b[49m\u001b[43m.\u001b[49m\u001b[43mheaders\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    649\u001b[39m \u001b[43m        \u001b[49m\u001b[43mredirect\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43;01mFalse\u001b[39;49;00m\u001b[43m,\u001b[49m\n\u001b[32m    650\u001b[39m \u001b[43m        \u001b[49m\u001b[43massert_same_host\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43;01mFalse\u001b[39;49;00m\u001b[43m,\u001b[49m\n\u001b[32m    651\u001b[39m \u001b[43m        \u001b[49m\u001b[43mpreload_content\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43;01mFalse\u001b[39;49;00m\u001b[43m,\u001b[49m\n\u001b[32m    652\u001b[39m \u001b[43m        \u001b[49m\u001b[43mdecode_content\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43;01mFalse\u001b[39;49;00m\u001b[43m,\u001b[49m\n\u001b[32m    653\u001b[39m \u001b[43m        \u001b[49m\u001b[43mretries\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mmax_retries\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    654\u001b[39m \u001b[43m        \u001b[49m\u001b[43mtimeout\u001b[49m\u001b[43m=\u001b[49m\u001b[43mtimeout\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    655\u001b[39m \u001b[43m        \u001b[49m\u001b[43mchunked\u001b[49m\u001b[43m=\u001b[49m\u001b[43mchunked\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    656\u001b[39m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    658\u001b[39m \u001b[38;5;28;01mexcept\u001b[39;00m (ProtocolError, \u001b[38;5;167;01mOSError\u001b[39;00m) \u001b[38;5;28;01mas\u001b[39;00m err:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/urllib3/connectionpool.py:841\u001b[39m, in \u001b[36mHTTPConnectionPool.urlopen\u001b[39m\u001b[34m(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, preload_content, decode_content, **response_kw)\u001b[39m\n\u001b[32m    839\u001b[39m     new_e = ProtocolError(\u001b[33m\"\u001b[39m\u001b[33mConnection aborted.\u001b[39m\u001b[33m\"\u001b[39m, new_e)\n\u001b[32m--> \u001b[39m\u001b[32m841\u001b[39m retries = \u001b[43mretries\u001b[49m\u001b[43m.\u001b[49m\u001b[43mincrement\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m    842\u001b[39m \u001b[43m    \u001b[49m\u001b[43mmethod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43murl\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43merror\u001b[49m\u001b[43m=\u001b[49m\u001b[43mnew_e\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m_pool\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m_stacktrace\u001b[49m\u001b[43m=\u001b[49m\u001b[43msys\u001b[49m\u001b[43m.\u001b[49m\u001b[43mexc_info\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m[\u001b[49m\u001b[32;43m2\u001b[39;49m\u001b[43m]\u001b[49m\n\u001b[32m    843\u001b[39m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    844\u001b[39m retries.sleep()\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/urllib3/util/retry.py:535\u001b[39m, in \u001b[36mRetry.increment\u001b[39m\u001b[34m(self, method, url, response, error, _pool, _stacktrace)\u001b[39m\n\u001b[32m    534\u001b[39m     reason = error \u001b[38;5;129;01mor\u001b[39;00m ResponseError(cause)\n\u001b[32m--> \u001b[39m\u001b[32m535\u001b[39m     \u001b[38;5;28;01mraise\u001b[39;00m MaxRetryError(_pool, url, reason) \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mreason\u001b[39;00m  \u001b[38;5;66;03m# type: ignore[arg-type]\u001b[39;00m\n\u001b[32m    537\u001b[39m log.debug(\u001b[33m\"\u001b[39m\u001b[33mIncremented Retry for (url=\u001b[39m\u001b[33m'\u001b[39m\u001b[38;5;132;01m%s\u001b[39;00m\u001b[33m'\u001b[39m\u001b[33m): \u001b[39m\u001b[38;5;132;01m%r\u001b[39;00m\u001b[33m\"\u001b[39m, url, new_retry)\n\n\u001b[31mMaxRetryError\u001b[39m: HTTPSConnectionPool(host='wcc.sc.egov.usda.gov', port=443): Max retries exceeded with url: /awdbWebService/services?WSDL (Caused by ConnectTimeoutError(<HTTPSConnection(host='wcc.sc.egov.usda.gov', port=443) at 0x7fc7ad3697f0>, 'Connection to wcc.sc.egov.usda.gov timed out. (connect timeout=300)'))\n\nDuring handling of the above exception, another exception occurred:\n\n\u001b[31mConnectTimeout\u001b[39m                            Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[4]\u001b[39m\u001b[32m, line 2\u001b[39m\n\u001b[32m      1\u001b[39m \u001b[38;5;66;03m# Find SNOTEL stations within polygon with desired variables\u001b[39;00m\n\u001b[32m----> \u001b[39m\u001b[32m2\u001b[39m points = \u001b[43mSnotelPointData\u001b[49m\u001b[43m.\u001b[49m\u001b[43mpoints_from_geometry\u001b[49m\u001b[43m(\u001b[49m\u001b[43msf\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mvariables\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m      4\u001b[39m \u001b[38;5;66;03m# Print nearby SNOTEL stations within 0.5 degrees of polygon\u001b[39;00m\n\u001b[32m      5\u001b[39m \u001b[38;5;28mprint\u001b[39m(SnotelPointData.points_from_geometry(sf, variables, buffer=\u001b[32m0.5\u001b[39m).points)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/metloom/pointdata/snotel.py:291\u001b[39m, in \u001b[36mSnotelPointData.points_from_geometry\u001b[39m\u001b[34m(cls, geometry, variables, **kwargs)\u001b[39m\n\u001b[32m    273\u001b[39m search_kwargs = {\n\u001b[32m    274\u001b[39m     \u001b[33m\"\u001b[39m\u001b[33mmax_latitude\u001b[39m\u001b[33m\"\u001b[39m: bounds[\u001b[33m\"\u001b[39m\u001b[33mmaxy\u001b[39m\u001b[33m\"\u001b[39m] + buffer,\n\u001b[32m    275\u001b[39m     \u001b[33m\"\u001b[39m\u001b[33mmin_latitude\u001b[39m\u001b[33m\"\u001b[39m: bounds[\u001b[33m\"\u001b[39m\u001b[33mminy\u001b[39m\u001b[33m\"\u001b[39m] - buffer,\n\u001b[32m   (...)\u001b[39m\u001b[32m    278\u001b[39m     \u001b[33m\"\u001b[39m\u001b[33mnetwork_cds\u001b[39m\u001b[33m\"\u001b[39m: network,\n\u001b[32m    279\u001b[39m }\n\u001b[32m    280\u001b[39m \u001b[38;5;28;01mfor\u001b[39;00m variable \u001b[38;5;129;01min\u001b[39;00m variables:\n\u001b[32m    281\u001b[39m     \u001b[38;5;66;03m# this search is default AND on all parameters\u001b[39;00m\n\u001b[32m    282\u001b[39m     \u001b[38;5;66;03m# so search for each variable seperately\u001b[39;00m\n\u001b[32m    283\u001b[39m     response = \u001b[43mPointSearchSnotelClient\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m    284\u001b[39m \u001b[43m        \u001b[49m\u001b[43melement_cds\u001b[49m\u001b[43m=\u001b[49m\u001b[43mvariable\u001b[49m\u001b[43m.\u001b[49m\u001b[43mcode\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    285\u001b[39m \u001b[43m        \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43msearch_kwargs\u001b[49m\n\u001b[32m    286\u001b[39m \u001b[43m        \u001b[49m\u001b[38;5;66;43;03m# ordinals=  # TODO: what are ordinals?\u001b[39;49;00m\n\u001b[32m    287\u001b[39m \u001b[43m        \u001b[49m\u001b[38;5;66;43;03m# ordinals are NRCS descriptors for parameters that may have multiple\u001b[39;49;00m\n\u001b[32m    288\u001b[39m \u001b[43m        \u001b[49m\u001b[38;5;66;43;03m# measurements, such as two pillows at a site, or two measurements of\u001b[39;49;00m\n\u001b[32m    289\u001b[39m \u001b[43m        \u001b[49m\u001b[38;5;66;43;03m# SWE from the same pillow. Fairly comfortable with the idea that we\u001b[39;49;00m\n\u001b[32m    290\u001b[39m \u001b[43m        \u001b[49m\u001b[38;5;66;43;03m# can assume ordinal=1\u001b[39;49;00m\n\u001b[32m--> \u001b[39m\u001b[32m291\u001b[39m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\u001b[43m.\u001b[49m\u001b[43mget_data\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    292\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(response) > \u001b[32m0\u001b[39m:\n\u001b[32m    293\u001b[39m         point_codes += response\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/metloom/pointdata/snotel_client.py:84\u001b[39m, in \u001b[36mBaseSnotelClient.get_data\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m     80\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mget_data\u001b[39m(\u001b[38;5;28mself\u001b[39m):\n\u001b[32m     81\u001b[39m \u001b[38;5;250m    \u001b[39m\u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m     82\u001b[39m \u001b[33;03m    Make the actual request and return data.\u001b[39;00m\n\u001b[32m     83\u001b[39m \u001b[33;03m    \"\"\"\u001b[39;00m\n\u001b[32m---> \u001b[39m\u001b[32m84\u001b[39m     data = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_make_request\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mparams\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     85\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m data\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/metloom/pointdata/snotel_client.py:73\u001b[39m, in \u001b[36mBaseSnotelClient._make_request\u001b[39m\u001b[34m(cls, **params)\u001b[39m\n\u001b[32m     69\u001b[39m \u001b[38;5;250m\u001b[39m\u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m     70\u001b[39m \u001b[33;03mMake the request to the SOAP client for the implemented service.\u001b[39;00m\n\u001b[32m     71\u001b[39m \u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m     72\u001b[39m \u001b[38;5;28;01mwith\u001b[39;00m no_ssl_verification():\n\u001b[32m---> \u001b[39m\u001b[32m73\u001b[39m     client = \u001b[43mzeep\u001b[49m\u001b[43m.\u001b[49m\u001b[43mClient\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m     74\u001b[39m \u001b[43m        \u001b[49m\u001b[38;5;28;43mcls\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mURL\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m     75\u001b[39m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     76\u001b[39m     service = \u001b[38;5;28mgetattr\u001b[39m(client.service, \u001b[38;5;28mcls\u001b[39m.SERVICE_NAME)\n\u001b[32m     77\u001b[39m     response = service(**params)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/zeep/client.py:76\u001b[39m, in \u001b[36mClient.__init__\u001b[39m\u001b[34m(self, wsdl, wsse, transport, service_name, port_name, plugins, settings)\u001b[39m\n\u001b[32m     74\u001b[39m     \u001b[38;5;28mself\u001b[39m.wsdl = wsdl\n\u001b[32m     75\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m---> \u001b[39m\u001b[32m76\u001b[39m     \u001b[38;5;28mself\u001b[39m.wsdl = \u001b[43mDocument\u001b[49m\u001b[43m(\u001b[49m\u001b[43mwsdl\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mtransport\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43msettings\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43msettings\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     77\u001b[39m \u001b[38;5;28mself\u001b[39m.wsse = wsse\n\u001b[32m     78\u001b[39m \u001b[38;5;28mself\u001b[39m.plugins = plugins \u001b[38;5;28;01mif\u001b[39;00m plugins \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;28;01melse\u001b[39;00m []\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/zeep/wsdl/wsdl.py:86\u001b[39m, in \u001b[36mDocument.__init__\u001b[39m\u001b[34m(self, location, transport, base, settings)\u001b[39m\n\u001b[32m     77\u001b[39m \u001b[38;5;28mself\u001b[39m._definitions = (\n\u001b[32m     78\u001b[39m     {}\n\u001b[32m     79\u001b[39m )  \u001b[38;5;66;03m# type: typing.Dict[typing.Tuple[str, str], \"Definition\"]\u001b[39;00m\n\u001b[32m     80\u001b[39m \u001b[38;5;28mself\u001b[39m.types = Schema(\n\u001b[32m     81\u001b[39m     node=\u001b[38;5;28;01mNone\u001b[39;00m,\n\u001b[32m     82\u001b[39m     transport=\u001b[38;5;28mself\u001b[39m.transport,\n\u001b[32m     83\u001b[39m     location=\u001b[38;5;28mself\u001b[39m.location,\n\u001b[32m     84\u001b[39m     settings=\u001b[38;5;28mself\u001b[39m.settings,\n\u001b[32m     85\u001b[39m )\n\u001b[32m---> \u001b[39m\u001b[32m86\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mload\u001b[49m\u001b[43m(\u001b[49m\u001b[43mlocation\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/zeep/wsdl/wsdl.py:89\u001b[39m, in \u001b[36mDocument.load\u001b[39m\u001b[34m(self, location)\u001b[39m\n\u001b[32m     88\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mload\u001b[39m(\u001b[38;5;28mself\u001b[39m, location):\n\u001b[32m---> \u001b[39m\u001b[32m89\u001b[39m     document = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_get_xml_document\u001b[49m\u001b[43m(\u001b[49m\u001b[43mlocation\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     91\u001b[39m     root_definitions = Definition(\u001b[38;5;28mself\u001b[39m, document, \u001b[38;5;28mself\u001b[39m.location)\n\u001b[32m     92\u001b[39m     root_definitions.resolve_imports()\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/zeep/wsdl/wsdl.py:149\u001b[39m, in \u001b[36mDocument._get_xml_document\u001b[39m\u001b[34m(self, location)\u001b[39m\n\u001b[32m    141\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34m_get_xml_document\u001b[39m(\u001b[38;5;28mself\u001b[39m, location: typing.IO) -> etree._Element:\n\u001b[32m    142\u001b[39m \u001b[38;5;250m    \u001b[39m\u001b[33;03m\"\"\"Load the XML content from the given location and return an\u001b[39;00m\n\u001b[32m    143\u001b[39m \u001b[33;03m    lxml.Element object.\u001b[39;00m\n\u001b[32m    144\u001b[39m \n\u001b[32m   (...)\u001b[39m\u001b[32m    147\u001b[39m \n\u001b[32m    148\u001b[39m \u001b[33;03m    \"\"\"\u001b[39;00m\n\u001b[32m--> \u001b[39m\u001b[32m149\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mload_external\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m    150\u001b[39m \u001b[43m        \u001b[49m\u001b[43mlocation\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mtransport\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mlocation\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43msettings\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43msettings\u001b[49m\n\u001b[32m    151\u001b[39m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/zeep/loader.py:89\u001b[39m, in \u001b[36mload_external\u001b[39m\u001b[34m(url, transport, base_url, settings)\u001b[39m\n\u001b[32m     87\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m base_url:\n\u001b[32m     88\u001b[39m         url = absolute_location(url, base_url)\n\u001b[32m---> \u001b[39m\u001b[32m89\u001b[39m     content = \u001b[43mtransport\u001b[49m\u001b[43m.\u001b[49m\u001b[43mload\u001b[49m\u001b[43m(\u001b[49m\u001b[43murl\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     90\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m parse_xml(content, transport, base_url, settings=settings)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/zeep/transports.py:132\u001b[39m, in \u001b[36mTransport.load\u001b[39m\u001b[34m(self, url)\u001b[39m\n\u001b[32m    129\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m response:\n\u001b[32m    130\u001b[39m         \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mbytes\u001b[39m(response)\n\u001b[32m--> \u001b[39m\u001b[32m132\u001b[39m content = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_load_remote_data\u001b[49m\u001b[43m(\u001b[49m\u001b[43murl\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    134\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m.cache:\n\u001b[32m    135\u001b[39m     \u001b[38;5;28mself\u001b[39m.cache.add(url, content)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/zeep/transports.py:144\u001b[39m, in \u001b[36mTransport._load_remote_data\u001b[39m\u001b[34m(self, url)\u001b[39m\n\u001b[32m    142\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34m_load_remote_data\u001b[39m(\u001b[38;5;28mself\u001b[39m, url):\n\u001b[32m    143\u001b[39m     \u001b[38;5;28mself\u001b[39m.logger.debug(\u001b[33m\"\u001b[39m\u001b[33mLoading remote data from: \u001b[39m\u001b[38;5;132;01m%s\u001b[39;00m\u001b[33m\"\u001b[39m, url)\n\u001b[32m--> \u001b[39m\u001b[32m144\u001b[39m     response = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43msession\u001b[49m\u001b[43m.\u001b[49m\u001b[43mget\u001b[49m\u001b[43m(\u001b[49m\u001b[43murl\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mtimeout\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mload_timeout\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    145\u001b[39m     \u001b[38;5;28;01mwith\u001b[39;00m closing(response):\n\u001b[32m    146\u001b[39m         response.raise_for_status()\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/requests/sessions.py:602\u001b[39m, in \u001b[36mSession.get\u001b[39m\u001b[34m(self, url, **kwargs)\u001b[39m\n\u001b[32m    594\u001b[39m \u001b[38;5;250m\u001b[39m\u001b[33mr\u001b[39m\u001b[33;03m\"\"\"Sends a GET request. Returns :class:`Response` object.\u001b[39;00m\n\u001b[32m    595\u001b[39m \n\u001b[32m    596\u001b[39m \u001b[33;03m:param url: URL for the new :class:`Request` object.\u001b[39;00m\n\u001b[32m    597\u001b[39m \u001b[33;03m:param \\*\\*kwargs: Optional arguments that ``request`` takes.\u001b[39;00m\n\u001b[32m    598\u001b[39m \u001b[33;03m:rtype: requests.Response\u001b[39;00m\n\u001b[32m    599\u001b[39m \u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    601\u001b[39m kwargs.setdefault(\u001b[33m\"\u001b[39m\u001b[33mallow_redirects\u001b[39m\u001b[33m\"\u001b[39m, \u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[32m--> \u001b[39m\u001b[32m602\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mrequest\u001b[49m\u001b[43m(\u001b[49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43mGET\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43murl\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/requests/sessions.py:589\u001b[39m, in \u001b[36mSession.request\u001b[39m\u001b[34m(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, stream, verify, cert, json)\u001b[39m\n\u001b[32m    584\u001b[39m send_kwargs = {\n\u001b[32m    585\u001b[39m     \u001b[33m\"\u001b[39m\u001b[33mtimeout\u001b[39m\u001b[33m\"\u001b[39m: timeout,\n\u001b[32m    586\u001b[39m     \u001b[33m\"\u001b[39m\u001b[33mallow_redirects\u001b[39m\u001b[33m\"\u001b[39m: allow_redirects,\n\u001b[32m    587\u001b[39m }\n\u001b[32m    588\u001b[39m send_kwargs.update(settings)\n\u001b[32m--> \u001b[39m\u001b[32m589\u001b[39m resp = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43msend\u001b[49m\u001b[43m(\u001b[49m\u001b[43mprep\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43msend_kwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    591\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m resp\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/requests/sessions.py:703\u001b[39m, in \u001b[36mSession.send\u001b[39m\u001b[34m(self, request, **kwargs)\u001b[39m\n\u001b[32m    700\u001b[39m start = preferred_clock()\n\u001b[32m    702\u001b[39m \u001b[38;5;66;03m# Send the request\u001b[39;00m\n\u001b[32m--> \u001b[39m\u001b[32m703\u001b[39m r = \u001b[43madapter\u001b[49m\u001b[43m.\u001b[49m\u001b[43msend\u001b[49m\u001b[43m(\u001b[49m\u001b[43mrequest\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    705\u001b[39m \u001b[38;5;66;03m# Total elapsed time of the request (approximately)\u001b[39;00m\n\u001b[32m    706\u001b[39m elapsed = preferred_clock() - start\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/snow-observations-cookbook-test/lib/python3.14/site-packages/requests/adapters.py:665\u001b[39m, in \u001b[36mHTTPAdapter.send\u001b[39m\u001b[34m(self, request, stream, timeout, verify, cert, proxies)\u001b[39m\n\u001b[32m    662\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(e.reason, ConnectTimeoutError):\n\u001b[32m    663\u001b[39m     \u001b[38;5;66;03m# TODO: Remove this in 3.0.0: see #2811\u001b[39;00m\n\u001b[32m    664\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(e.reason, NewConnectionError):\n\u001b[32m--> \u001b[39m\u001b[32m665\u001b[39m         \u001b[38;5;28;01mraise\u001b[39;00m ConnectTimeout(e, request=request)\n\u001b[32m    667\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(e.reason, ResponseError):\n\u001b[32m    668\u001b[39m     \u001b[38;5;28;01mraise\u001b[39;00m RetryError(e, request=request)\n\n\u001b[31mConnectTimeout\u001b[39m: HTTPSConnectionPool(host='wcc.sc.egov.usda.gov', port=443): Max retries exceeded with url: /awdbWebService/services?WSDL (Caused by ConnectTimeoutError(<HTTPSConnection(host='wcc.sc.egov.usda.gov', port=443) at 0x7fc7ad3697f0>, 'Connection to wcc.sc.egov.usda.gov timed out. (connect timeout=300)'))","ename":"ConnectTimeout","evalue":"HTTPSConnectionPool(host='wcc.sc.egov.usda.gov', port=443): Max retries exceeded with url: /awdbWebService/services?WSDL (Caused by ConnectTimeoutError(<HTTPSConnection(host='wcc.sc.egov.usda.gov', port=443) at 0x7fc7ad3697f0>, 'Connection to wcc.sc.egov.usda.gov timed out. (connect timeout=300)'))"},"key":"JQSqjBi0ws"}],"key":"mMnlKSlk9v"}],"key":"eq7MEOwcCb"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Looks like we have a SNOTEL station here! Note the printed output: Metloom returns the station ID number (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qaUglyclVV"},{"type":"inlineCode","value":"1302","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WzCXND2si0"},{"type":"text","value":"), the state it’s in (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mhXDCJ1XrB"},{"type":"inlineCode","value":"AK","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J2kfgpibSk"},{"type":"text","value":"), and the type of weather station (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n82owKkJXZ"},{"type":"inlineCode","value":"SNTL","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z0Hzrn6uII"},{"type":"text","value":").","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"drKgjmyMH5"}],"key":"x3EpG7jYS1"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s see where it’s located in Creamer’s Field, relative to the polyon we provided.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"D5d3iNufd5"}],"key":"HBmcA2PkDn"}],"key":"IhTHNQh5Od"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Plot lidar box over ESRI tiles\nm = sf.explore(\n    tooltip=False, color=\"grey\", highlight=False, tiles=\"Esri.WorldImagery\",\n    style_kwds={\"opacity\": 0.2}, popup=[\"name\"]\n)\n# Add plot showing location of SNOTEL station(s)\ndf = points.to_dataframe()\ndf.explore(m=m, tooltip=[\"name\", \"id\"], color=\"red\", marker_kwds={\"radius\":4})","key":"Zw7LgojE0F"},{"type":"outputs","id":"ueisxYLqj2gXhS2cd-LgE","children":[],"key":"c9c4OALCzf"}],"key":"Li6ydSZHZv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now that we know which SNOTEL is in the area, we can query for the data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dRY43qf6GU"}],"key":"NOPZJ011MI"}],"key":"d4DuGtAD4m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Define SNOTEL station from FLCF\npt = SnotelPointData(\"1302:AK:SNTL\", \"Creamer's Field\")","key":"KT43HYnoTo"},{"type":"outputs","id":"g5Ek6uJy0ZtXCynbux-1h","children":[],"key":"ahD6AQzkwy"}],"key":"P7Loc0BtZ3"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As with other API requests, we can subset the data with a date range, given as datetime objects.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MJfct7h5Wd"}],"key":"wz8DcEivoT"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Note here that we are requesting for snow depths on a daily basis. If desired, we could also obtain the hourly data instead, using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UpOQtoIb3K"},{"type":"inlineCode","value":"pt.get_hourly_data()","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oxmfjM40rL"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"U1fseUzSDx"}],"key":"r6SBJEo8D6"}],"key":"cjXWlaXdU2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Start and end date of SNOTEL query\nstart_date = datetime(2022, 3, 1)\nend_date = datetime(2023, 4, 1)\n\n# Query SNOTEL snow depths\ndf = pt.get_daily_data(start_date, end_date, variables)","key":"zcN3gJdi16"},{"type":"outputs","id":"opJzTxTVia5wUEFSPnHfP","children":[],"key":"Dzv1yQjUDC"}],"key":"xuawpHxKv8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df.head()","key":"BRUAey6WJh"},{"type":"outputs","id":"I92Hfy2EsjQQzDrStbuhA","children":[],"key":"hTlnltqO6M"}],"key":"VWPWspih7n"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Easy enough! We now have a data frame containing the basic information of the SNOTEL site, as well as the snow depth in inches.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AIsyWX9BNJ"}],"key":"jhSF0wOhlr"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Since inches aren’t very useful in scientific analysis, and SNOWDEPTH can be a hassle to type out, let’s make a new column that shows the depth in meters.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mO4hrwXYYU"}],"key":"B5UAH2poQA"}],"key":"xThaWDWdUu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Convert snow depth to meters\ndf['snow_depth_meters'] = df['SNOWDEPTH']*0.0254","key":"P5Z5wkkR4B"},{"type":"outputs","id":"EabO6r5T3PcajT7isk7y_","children":[],"key":"xz8oRgWrCd"}],"key":"fI4n4wwZXi"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From there, it’s simple to plot the snow depth data as a time series.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YbSqulvwMS"}],"key":"zQXvvjkU6s"}],"key":"FAo6Txzkfn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Plot time series of daily SNOTEL data\nfig, ax = plt.subplots()\ndf.reset_index().set_index(\"datetime\")[\"snow_depth_meters\"].plot(ax=ax)\nax.set_xlabel(\"Date\", fontsize=12)\nax.set_ylabel(\"Snow depth [m]\", fontsize=12)\nax.set_title(\"SNOTEL: Creamer's Field (1302)\", fontsize=12)\nfig.tight_layout()","key":"IdNFJ9ngK6"},{"type":"outputs","id":"3Wy3l9K_O9Mp5KeaOPUVl","children":[],"key":"qFDPI43VVa"}],"key":"spIDoR1cNl"}],"key":"PRVK4IzbSZ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Terrestrial Laser Scanning","url":"/notebooks/tls-data-access","group":"Observations"}}},"domain":"http://localhost:3000"}